{"_path":"/migrations","_dir":"","_draft":false,"_partial":false,"_locale":"","title":"Migrations","description":"It is the documentation of the migrations between versions, problems\nencountered while migrating, solutions to problems and changes.","position":103,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"migrations"},"children":[{"type":"text","value":"Migrations"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"It is the documentation of the migrations between versions, problems\nencountered while migrating, solutions to problems and changes."}]},{"type":"element","tag":"h2","props":{"id":"node"},"children":[{"type":"text","value":"Node"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"Nuxt"}]},{"type":"text","value":" v3.7.4 requires "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"Node"}]},{"type":"text","value":" version v18 and above to work but we've decided\nto use v20. Make sure you have v20 installed in your local machine."}]},{"type":"element","tag":"h2","props":{"id":"nuxt-v341-v374"},"children":[{"type":"text","value":"Nuxt: v3.4.1 👉 v3.7.4"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"First we tried to upgrade to the new version of nuxt with upgrades, but the\nresulting conflicts got too complicated, you can see the upgrade process in\n"},{"type":"element","tag":"a","props":{"href":"./change-history/package-upgrades"},"children":[{"type":"text","value":"Package Upgrades"}]},{"type":"text","value":". So we proceeded by\ncreating a new nuxt project with the latest version of "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"nuxt-kit"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Below you can find a migration checklist;"}]},{"type":"element","tag":"pre","props":{"className":["language-markdown"],"code":"- [ ] upgrade node version on workflow\n- [ ] move `.theme` to `.theme-legacy`\n- [ ] create nuxt project (v3.7.4)\n- [ ] update `app.vue` code\n- [ ] install `nuxt-content` module & add as module in `nuxt.config.ts`\n- [ ] add dynamic page & create `.md` file in `/content` directory for demo\n- [ ] Disable `headings.anchorLinks`\n- [ ] install `sass` -> move assets from old project -> add styles in\n  `nuxt.config.ts`\n- [ ] move `.env` files from old project\n- [ ] add prefix to constants in `.env` file\n- [ ] update `runtimeConfig.public` (for `.env`)\n- [ ] move prebuild from old project\n- [ ] update `config.yml` for puppeteer warnings\n- [ ] add prebuild dependencies (`log-symbols`, `mermaid....`)\n- [ ] set all components global `true`\n- [ ] move all pages & and component from old project\n- [ ] move transformers & modules from old projects\n- [ ] move modules to under `/modules`\n- [ ] add `type` to type imports\n- [ ] add empty link to `nitro.prerender.failOnError`\n- [ ] make absolute image path\n- [ ] move eslintrc config and use only `@nuxtjs/eslint-config-typescript`\n- [ ] rename eslint config file as `.eslintrc`\n- [ ] add eslint run command to scripts\n- [ ] move your scripts from old project\n- [ ] remove build stage from scripts\n- [ ] set `PayloadExtraction` `false`\n- [ ] migration of remaining config in `nuxt.config.ts`\n- [ ] Edit incoming old config according to the new config(`.env` config structure etc.)\n- [ ] sort configs in `nuxt.config.ts`\n","language":"markdown","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"- [ ] upgrade node version on workflow\n- [ ] move `.theme` to `.theme-legacy`\n- [ ] create nuxt project (v3.7.4)\n- [ ] update `app.vue` code\n- [ ] install `nuxt-content` module & add as module in `nuxt.config.ts`\n- [ ] add dynamic page & create `.md` file in `/content` directory for demo\n- [ ] Disable `headings.anchorLinks`\n- [ ] install `sass` -> move assets from old project -> add styles in\n  `nuxt.config.ts`\n- [ ] move `.env` files from old project\n- [ ] add prefix to constants in `.env` file\n- [ ] update `runtimeConfig.public` (for `.env`)\n- [ ] move prebuild from old project\n- [ ] update `config.yml` for puppeteer warnings\n- [ ] add prebuild dependencies (`log-symbols`, `mermaid....`)\n- [ ] set all components global `true`\n- [ ] move all pages & and component from old project\n- [ ] move transformers & modules from old projects\n- [ ] move modules to under `/modules`\n- [ ] add `type` to type imports\n- [ ] add empty link to `nitro.prerender.failOnError`\n- [ ] make absolute image path\n- [ ] move eslintrc config and use only `@nuxtjs/eslint-config-typescript`\n- [ ] rename eslint config file as `.eslintrc`\n- [ ] add eslint run command to scripts\n- [ ] move your scripts from old project\n- [ ] remove build stage from scripts\n- [ ] set `PayloadExtraction` `false`\n- [ ] migration of remaining config in `nuxt.config.ts`\n- [ ] Edit incoming old config according to the new config(`.env` config structure etc.)\n- [ ] sort configs in `nuxt.config.ts`\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Start by running following command"}]},{"type":"element","tag":"pre","props":{"className":["language-bash"],"code":"npx nuxi@latest init .theme\n","language":"bash","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"npx nuxi@latest init .theme\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"During installation it will give you options.\nWhen it asks:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"package manager"}]},{"type":"text","value":":  Select "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"npm"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"initialize git repository"}]},{"type":"text","value":": select "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"No"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":":information_source:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Before creating a new project we recommend to move "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":".theme"}]},{"type":"text","value":" to\n"},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":".theme-legacy"}]},{"type":"text","value":". After renaming, don't forget to delete generate contents\nlike "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"/.nuxt"}]},{"type":"text","value":", "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"/node_modules"}]},{"type":"text","value":" etc. because too many changes will appear."}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":":warning:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"nuxi"}]},{"type":"text","value":" automatically install nuxt with the latest version. don't forget to\nset version to "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"v3.7.4"}]},{"type":"text","value":" in "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"package.json"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Change the code in "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"app.vue"}]},{"type":"text","value":" as follows"}]},{"type":"element","tag":"pre","props":{"className":["language-vue"],"code":"<template>\n  <NuxtLayout name=\"default\">\n    <NuxtPage />\n  </NuxtLayout>\n</template>\n","language":"vue","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"<template>\n  <NuxtLayout name=\"default\">\n    <NuxtPage />\n  </NuxtLayout>\n</template>\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Navigate to the "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"/.theme"}]},{"type":"text","value":" directory "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"npm run dev"}]},{"type":"text","value":" run the command."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"When you change the code, you will see a blank html page because a page has\nnot been added yet."}]},{"type":"element","tag":"h3","props":{"id":"adding-nuxt-content-module"},"children":[{"type":"text","value":"Adding Nuxt Content Module"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Add content module run following command"}]},{"type":"element","tag":"pre","props":{"className":["language-bash"],"code":"npm install @nuxt/content --save-dev\n","language":"bash","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"npm install @nuxt/content --save-dev\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Create new page "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"[...content-page].vue"}]},{"type":"text","value":" and add this code to under "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"/pages"}]},{"type":"text","value":"\ndirectory"}]},{"type":"element","tag":"pre","props":{"className":["language-vue"],"code":"<template>\n  <ContentDoc />\n</template>\n","language":"vue","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"<template>\n  <ContentDoc />\n</template>\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Configure "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"nuxt.config.ts"}]}]},{"type":"element","tag":"pre","props":{"className":["language-ts"],"code":"export default defineNuxtConfig({\n  devtools: { enabled: true },\n  modules: [\n    '@nuxt/content'\n  ],\n  content: {\n    // ... options\n  }\n})\n","language":"ts","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"export default defineNuxtConfig({\n  devtools: { enabled: true },\n  modules: [\n    '@nuxt/content'\n  ],\n  content: {\n    // ... options\n  }\n})\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The nuxt content module will not be able to access any content at this stage\nbecause it is looking for a file with "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":".md"}]},{"type":"text","value":" extension under "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"/content"}]},{"type":"text","value":".\nTherefore, you may see a warning like "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"Document not found"}]},{"type":"text","value":" on the screen."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you have come this far, create a markdown file called "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"index.md"}]},{"type":"text","value":" under the\n"},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"/content"}]},{"type":"text","value":" folder. Display your page by saying "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"npm run dev"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h4","props":{"id":"disable-headingsanchorlinks-option"},"children":[{"type":"text","value":"Disable "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"headings.anchorLinks"}]},{"type":"text","value":" option"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"By default, headers come in link format and the render will be as follows."}]},{"type":"element","tag":"pre","props":{"className":["language-html"],"code":"<h2 id=\"head\"...>\n  <a href=\"#head\">\n    Head\n  </a>\n</h2>\n","language":"html","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"<h2 id=\"head\"...>\n  <a href=\"#head\">\n    Head\n  </a>\n</h2>\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You can do the following configuration to turn it off and render normal text."}]},{"type":"element","tag":"pre","props":{"className":["language-ts"],"code":"export default defineNuxtConfig({\n  ...\n  runtimeConfig: {\n    public: {\n      mdc: {\n        headings: {\n          anchorLinks: {\n            h1: false,\n            h2: false,\n            h3: false,\n            h4: false,\n            h5: false,\n            h6: false,\n          },\n        },\n      },\n    },\n  },\n});\n","language":"ts","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"export default defineNuxtConfig({\n  ...\n  runtimeConfig: {\n    public: {\n      mdc: {\n        headings: {\n          anchorLinks: {\n            h1: false,\n            h2: false,\n            h3: false,\n            h4: false,\n            h5: false,\n            h6: false,\n          },\n        },\n      },\n    },\n  },\n});\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"the output is as follows."}]},{"type":"element","tag":"pre","props":{"className":["language-html"],"code":"<h2 id=\"head\"...>\n  Head\n</h2>\n","language":"html","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"<h2 id=\"head\"...>\n  Head\n</h2>\n"}]}]},{"type":"element","tag":"h3","props":{"id":"sass-css"},"children":[{"type":"text","value":"Sass & Css"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You can make these configurations to source css to the project from outside."}]},{"type":"element","tag":"pre","props":{"className":["language-ts"],"code":"export default defineNuxtConfig({\n  ...\n  app: {\n    head: {\n      ...\n      link: [\n        {\n          rel: \"stylesheet\",\n          type: \"text/css\",\n          href: \"https://mouseless.github.io/brand/assets/css/default.css\"\n        }\n      ]\n    }\n  },\n  css: [\"~/assets/styles.css\"]\n})\n","language":"ts","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"export default defineNuxtConfig({\n  ...\n  app: {\n    head: {\n      ...\n      link: [\n        {\n          rel: \"stylesheet\",\n          type: \"text/css\",\n          href: \"https://mouseless.github.io/brand/assets/css/default.css\"\n        }\n      ]\n    }\n  },\n  css: [\"~/assets/styles.css\"]\n})\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"to export sass files first install sass"}]},{"type":"element","tag":"pre","props":{"className":["language-bash"],"code":"npm install sass --save-dev\n","language":"bash","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"npm install sass --save-dev\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"then put your style files under "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"/assets"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You can then configure "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"nuxt.config.ts"}]},{"type":"text","value":" as follows to apply your styles and\naccess style variables from vue files."}]},{"type":"element","tag":"pre","props":{"className":["language-ts"],"code":"export default defineNuxtConfig({\n  ...\n  vite: {\n    css: {\n      preprocessorOptions: {\n        scss: {\n          additionalData: \"@import \\\"@/assets/variables.scss\\\";\"\n        }\n      }\n    }\n  },\n  css: [\"~/assets/styles.scss\"]\n})\n","language":"ts","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"export default defineNuxtConfig({\n  ...\n  vite: {\n    css: {\n      preprocessorOptions: {\n        scss: {\n          additionalData: \"@import \\\"@/assets/variables.scss\\\";\"\n        }\n      }\n    }\n  },\n  css: [\"~/assets/styles.scss\"]\n})\n"}]}]},{"type":"element","tag":"h3","props":{"id":"env-files"},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":".env.*"}]},{"type":"text","value":" files"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"By adding environment files, you can export these files during build and use\nyour constant values during build or runtime."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"After getting your env files from the old project, give the relevant "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":".env"}]},{"type":"text","value":"\nfiles to the places you want in the scripts in "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"package.json"}]},{"type":"text","value":" to apply them to\nthe project."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"\"dev\": \"npx nuxi dev --dotenv .env.local\""}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you write your constant values with the prefix "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"NUXT"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"NUXT_PUBLIC"}]},{"type":"text","value":" in\nyour env file, nuxt will match them automatically."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"NUXT_PUBLIC_BASE_URL=/"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"must have a match in "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"runtimeConfig.public"}]},{"type":"text","value":" for automatic mapping. It should\nbe as follows."}]},{"type":"element","tag":"pre","props":{"className":["language-ts"],"code":"export default defineNuxtConfig({\n  runtimeConfig: {\n    public: {\n      baseUrl: \"\"\n    }\n  },\n});\n","language":"ts","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"export default defineNuxtConfig({\n  runtimeConfig: {\n    public: {\n      baseUrl: \"\"\n    }\n  },\n});\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To access it from somewhere other than "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"runtimeConfig"}]},{"type":"text","value":", you can call it as\n"},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"process.env.NUXT_PUBLIC_BASE_URL"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h3","props":{"id":"prebuild"},"children":[{"type":"text","value":"Prebuild"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In the setup phase with prebuild, we prepare the markdowns at the root\nand put them under content. We also prepare the corresponding pages and pull\nthe markdown content in these pages and render them."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"After "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"prebuild"}]},{"type":"text","value":" make sure that the folder where the public files are moved\nfrom "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"nuxt.config.ts"}]},{"type":"text","value":" is set correctly."}]},{"type":"element","tag":"pre","props":{"className":["language-ts"],"code":"export default defineNuxtConfig({\n  ...\n  dir: {\n    public: \".public\"\n  },\n})\n","language":"ts","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"export default defineNuxtConfig({\n  ...\n  dir: {\n    public: \".public\"\n  },\n})\n"}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":":information_source:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Don't forget to install the dependencies of the prebuild."}]},{"type":"element","tag":"pre","props":{"className":["language-bash"],"code":"npm install log-symbols --save-dev\nnpm install @mermaid-js/mermaid-cli --save-dev\n","language":"bash","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"npm install log-symbols --save-dev\nnpm install @mermaid-js/mermaid-cli --save-dev\n"}]}]}]},{"type":"element","tag":"h4","props":{"id":"configyml"},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"config.yml"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"When you get the prebuild from your old project or when you write a new one,\nyou can remove "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"puppeteer"}]},{"type":"text","value":" warnings by saying "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"config.headless: new"}]},{"type":"text","value":" while\nextracting mermaid diagrams in "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"config.yml"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h3","props":{"id":"components"},"children":[{"type":"text","value":"Components"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You must do this configuration to access globally when writing and using\nthe component."}]},{"type":"element","tag":"pre","props":{"className":["language-ts"],"code":"export default defineNuxtConfig({\n  ...\n  components: {\n    dirs: [{ global: true, path: \"~/components/Prose\" }, \"~/components\"]\n  },\n})\n","language":"ts","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"export default defineNuxtConfig({\n  ...\n  components: {\n    dirs: [{ global: true, path: \"~/components/Prose\" }, \"~/components\"]\n  },\n})\n"}]}]},{"type":"element","tag":"h3","props":{"id":"new-module-nuxt-content-transformer"},"children":[{"type":"text","value":"New module & Nuxt Content transformer"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To intervene when "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"nuxt content"}]},{"type":"text","value":" reads markdowns and converts them to html\nobject, we need to use the "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"transformer"}]},{"type":"text","value":" feature of "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"nuxt content"}]},{"type":"text","value":", to do\nthis we need to add it as a module to nuxt."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Nuxt scans the "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"/modules"}]},{"type":"text","value":" directory and loads them before starting. If you\nadd them under "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"/modules"}]},{"type":"text","value":", you don't need to add those local modules to your\n"},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"nuxt.config.ts"}]},{"type":"text","value":" separately."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":":warning:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"only nuxt modules should be under "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"/modules"}]},{"type":"text","value":"."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To see the use of transformer "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"/transformers/optimus-prime.ts"}]},{"type":"text","value":"\nTo see how to add a module look "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"nuxt.config.ts"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h3","props":{"id":"types"},"children":[{"type":"text","value":"types"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"With version "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"v3.7.4"}]},{"type":"text","value":" of Nuxt, you must specify "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"Type"}]},{"type":"text","value":" at the beginning of the\ntype in type imports as below."}]},{"type":"element","tag":"pre","props":{"className":["language-ts"],"code":"import type { TestNewProps } from '~~/types';\n","language":"ts","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"import type { TestNewProps } from '~~/types';\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"or"}]},{"type":"element","tag":"pre","props":{"className":["language-ts"],"code":"import { type TestNewProps } from '~~/types';\n","language":"ts","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"import { type TestNewProps } from '~~/types';\n"}]}]},{"type":"element","tag":"h3","props":{"id":"prerender-fail"},"children":[{"type":"text","value":"Prerender fail"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"After version nuxt 3.6.2, if a page corresponding to the link cannot be found,\nit gives generate error."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"For solution you can make "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"nitro.prerender.failOnError"}]},{"type":"text","value":" "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"false"}]},{"type":"text","value":" or add path to\n"},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"nitro.prerender.ignore"}]},{"type":"text","value":" array."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"See "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"nuxt.config.ts"}]},{"type":"text","value":" for example."}]},{"type":"element","tag":"h3","props":{"id":"trailing-slash"},"children":[{"type":"text","value":"Trailing slash"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"With the new nuxt version, the trailing slash solution we found earlier no\nlonger works. So we removed the solution for trailing slash in\n"},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"[...content-page].vue"}]},{"type":"text","value":" and the "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"router.options.strict: true"}]},{"type":"text","value":" setting in\n"},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"nuxt.config.ts"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In the new version, the trailing slash causes problems with images. As a\nsolution, we saw that the change we made in ProseImg reflected the change made\nin the prerender phase. Therefore, we removed the page part from the paths of\nthe images in the files that are not on the index page in the prerender phase.\nIn this way, it searches the image under the relevant file."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"See "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"ProseImg.vue"}]},{"type":"text","value":" component in "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"components/Prose"}]},{"type":"text","value":" folder for how to fix\ntrailing slash issue."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"See here for possible img cases.\n"},{"type":"element","tag":"a","props":{"href":"./test/"},"children":[{"type":"text","value":"test"}]}]},{"type":"element","tag":"h3","props":{"id":"move-packagejson-scripts"},"children":[{"type":"text","value":"Move "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"package.json"}]},{"type":"text","value":" scripts"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You can move your scripts in "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"package.json"}]},{"type":"text","value":" from your old project. There is no\nneed to build before Generate and Development, remove it from your scripts."}]},{"type":"element","tag":"h3","props":{"id":"eslint"},"children":[{"type":"text","value":"Eslint"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Move your Eslint files and rename the config files to "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":".eslintrc"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"@nuxtjs/eslint-config-typescript"}]},{"type":"text","value":" module is sufficient by itself, so\nother modules have been removed from eslint."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"For eslint to work, you can run it in the setup script in "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"package.json"}]},{"type":"text","value":" with\n"},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"npx eslint ."}]},{"type":"text","value":" or if you have added eslint to dependencies, you can run it\nwith "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"eslint ."}]},{"type":"text","value":" before build."}]},{"type":"element","tag":"h3","props":{"id":"removing-the-build-stage"},"children":[{"type":"text","value":"Removing the build stage"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Removing the build stage we added in generate. Now nuxt builds itself before\ngenerate. The build script that we want to run before generate has been\nremoved from the scripts."}]},{"type":"element","tag":"h3","props":{"id":"payloadextraction"},"children":[{"type":"text","value":"PayloadExtraction"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We do not want the "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"_payload.json"}]},{"type":"text","value":" file to be created, so we set\n"},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"experimental.payloadExtraction"}]},{"type":"text","value":" to "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"false"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h3","props":{"id":"migration-nuxtconfigts"},"children":[{"type":"text","value":"Migration "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"nuxt.config.ts"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"At this point, if there is a config left in your old file, move your config\nother than the following."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"router.options.strict: true"}]},{"type":"text","value":" ❌"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"typescript.typeCheck: true"}]},{"type":"text","value":" ❌"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"These configs are no longer needed. Apart from these, you can move your\nconfigurations in "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"runtimeConfig"}]},{"type":"text","value":" or routes that you want to be generated."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Remember to sort the config in name order after the migration."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":":information_source:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Don't forget to review the remaining config from the old project when you\nmigrate. Since the config from the "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":".env"}]},{"type":"text","value":" file is renamed, your config such\nas "},{"type":"element","tag":"code","props":{"className":""},"children":[{"type":"text","value":"app.baseUrl"}]},{"type":"text","value":" may be corrupted etc."}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"node","depth":2,"text":"Node"},{"id":"nuxt-v341-v374","depth":2,"text":"Nuxt: v3.4.1 👉 v3.7.4","children":[{"id":"adding-nuxt-content-module","depth":3,"text":"Adding Nuxt Content Module"},{"id":"sass-css","depth":3,"text":"Sass & Css"},{"id":"env-files","depth":3,"text":".env.* files"},{"id":"prebuild","depth":3,"text":"Prebuild"},{"id":"components","depth":3,"text":"Components"},{"id":"new-module-nuxt-content-transformer","depth":3,"text":"New module & Nuxt Content transformer"},{"id":"types","depth":3,"text":"types"},{"id":"prerender-fail","depth":3,"text":"Prerender fail"},{"id":"trailing-slash","depth":3,"text":"Trailing slash"},{"id":"move-packagejson-scripts","depth":3,"text":"Move package.json scripts"},{"id":"eslint","depth":3,"text":"Eslint"},{"id":"removing-the-build-stage","depth":3,"text":"Removing the build stage"},{"id":"payloadextraction","depth":3,"text":"PayloadExtraction"},{"id":"migration-nuxtconfigts","depth":3,"text":"Migration nuxt.config.ts"}]}]}},"_type":"markdown","_id":"content:migrations.md","_source":"content","_file":"migrations.md","_extension":"md"}